<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ã‰vÃ©nements - Guardia</title>
    <link rel="stylesheet" href="evenement.css">
</head>
<body>

    <canvas id="matrixCanvas"></canvas>

    <header class="navbar">
        <nav>
            <ul>
                <li><a href="index.html" class="nav-link">./accueil</a></li>
                <li><a href="bde.html" class="nav-link">./BDE</a></li>
                <li><a href="evenement.html" class="nav-link">./evenement</a></li>
                <li><a href="contact.html" class="nav-link">./contact</a></li>
                <li><a href="login.php" class="nav-link">./login</a></li>
            </ul>
        </nav>
    </header>

    <main class="content-section">
        <div class="logo-container">
            <img src="image.png" alt="Logo du Bureau des Ã‰tudiants ERROR" class="site-logo logo-bde">
            
            <img src="guardia-logo-104x100.png.webp" alt="Logo de l'Ã©cole GUARDIA" class="site-logo logo-guardia">
        </div>

        <div id="status-message-container" role="alert"></div>

        <div class="content-interior"> <h1 class="page-title">03\_Ã‰VÃ‰NEMENTS Ã€ VENIR</h1>
            
            <div class="events-grid">
                
                <div class="event-card interactive">
                    <div class="event-image-placeholder">
                        <img src="Gemini_Generated_Image_y53su2y53su2y53s.png" alt="Photo de LAN Party" class="event-photo">
                    </div>
                    <div class="event-details">
                        <h2 class="event-title">Raclette Party</h2>
                        <p class="event-info">Date : 5 DÃ©cembre</p>
                        <p class="event-info available-seats">Places disponibles : 35/50</p>
                        <p class="event-description">Une soirÃ©e chaleureuse entre Ã©tudiants autour dâ€™une raclette gÃ©ante, jeux et ambiance festive pour cÃ©lÃ©brer la fin dâ€™annÃ©e.</p>
                        <button class="location-button" data-location="22 Terr. Bellini, 92800 Puteaux" data-event-title="Raclette Party">Lieu ğŸ“</button> 
                        <a href="page dacceil raglette.html" class="event-button" data-template-id="raclette-template">S'inscrire</a> </div>
                </div>
                
                <div class="event-card interactive">
                    <div class="event-image-placeholder">
                        <img src="Gemini_Generated_Image_o19yto19yto19yto.png" alt="Photo de ConfÃ©rence Cyber" class="event-photo">
                    </div>
                    <div class="event-details">
                        <h2 class="event-title">BDE Santa Secret</h2>
                        <p class="event-info">Date : 15 DÃ©cembre</p>
                        <p class="event-info available-seats">Places disponibles : 8/100</p>
                        <p class="event-description">Un Ã©vÃ©nement spÃ©cial NoÃ«l rempli dâ€™animations, de surprises et dâ€™une ambiance festive pour clÃ´turer lâ€™annÃ©e.</p>
                        <button class="location-button" data-location="1 Parv. de la DÃ©fense, 92800 Paris La DÃ©fense" data-event-title="BDE Santa Secret">Lieu ğŸ“</button>
                        <a href="noel page dacceuil.html" class="event-button" data-template-id="noel-template">S'inscrire</a> </div>
                </div>

                <div class="event-card interactive">
                    <div class="event-image-placeholder">
                        <img src="Gemini_Generated_Image_eba34eeba34eeba3.png" alt="Photo d'activitÃ© sportive" class="event-photo">
                    </div>
                    <div class="event-details">
                        <h2 class="event-title">SoirÃ©e de NoÃ«l</h2>
                        <p class="event-info">Date : 20 DÃ©cembre</p>
                        <p class="event-info available-seats is-full">Places disponibles : COMPLET</p> 
                        <p class="event-description">Une soirÃ©e festive pour cÃ©lÃ©brer NoÃ«l entre Ã©tudiants, avec animations et activitÃ©s pour renforcer lâ€™esprit dâ€™Ã©quipe.</p>
                        <a href="#" class="event-button is-disabled">COMPLET</a> </div>
                </div>

                <div class="event-card interactive">
                    <div class="event-image-placeholder">
                        <img src="Gemini_Generated_Image_8besbw8besbw8bes.png" alt="Photo de locaux d'entreprise" class="event-photo">
                    </div>
                    <div class="event-details">
                        <h2 class="event-title">FÃªte de la galette des rois</h2>
                        <p class="event-info">Date : 15 Janvierr</p>
                        <p class="event-info available-seats">Places disponibles : 12/15</p>
                        <p class="event-description">Partagez un moment convivial autour de la galette et dÃ©couvrez une ambiance chaleureuse pour bien commencer lâ€™annÃ©e.</p>
                        <button class="location-button" data-location="22 Terr. Bellini, 92800 Puteaux" data-event-title="FÃªte de la galette des rois">Lieu ğŸ“</button>
                        <a href="galete des rois page.html" class="event-button" data-template-id="galette-template">S'inscrire</a> </div>
                </div>

            </div>
        </main>

        <template id="raclette-template">
            <div class="raglette-wrapper">
                <div class="registration-container">
                    <h1><span class="raclette-icon">ğŸ§€</span> Inscription SoirÃ©e Raclette <span class="raclette-icon">ğŸ·</span></h1>
                    <p>PrÃ©parez-vous pour le fromage fondu, les pommes de terre et la bonne humeur !</p>
                    <form action="inscription_event.php" method="POST" class="registration-form">
                        <input type="hidden" name="evenement" value="Raclette Party">
                        
                        <div class="form-group">
                            <label for="email-rac">Email :</label> <span class="input-icon" style="color: #007bff;">âœ‰ï¸</span>
                            <input type="email" id="email-rac" name="email" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="nom-rac">Nom :</label> <span class="input-icon" style="color: #FFD700;">ğŸ§€</span>
                            <input type="text" id="nom-rac" name="nom" required>
                        </div>
                        <div class="form-group">
                            <label for="prenom-rac">PrÃ©nom :</label> <span class="input-icon" style="color: #D2B48C;">ğŸ¥”</span>
                            <input type="text" id="prenom-rac" name="prenom" required>
                        </div>
                        <div class="form-group">
                            <label for="numero-rac">NumÃ©ro de tÃ©lÃ©phone :</label> <span class="input-icon" style="color: #8B0000;">ğŸ·</span>
                            <input type="tel" id="numero-rac" name="telephone" pattern="[0-9]{10}" placeholder="Ex: 0612345678" required>
                        </div>
                        <button type="submit" class="submit-btn">Je fonce pour le fromage ! <span class="btn-icon">ğŸ”¥</span></button>
                    </form>
                </div>
            </div>
        </template>
        
        <template id="galette-template">
            <div class="galette-wrapper">
                <div class="registration-container galette-form-container">
                    <h1>ğŸ‘‘ Inscription FÃªte de la Galette des Rois</h1>
                    <p>Veuillez remplir les informations pour valider votre participation au tirage de la fÃ¨ve !</p>
                    <form action="inscription_event.php" method="POST" class="registration-form">
                        <input type="hidden" name="evenement" value="FÃªte de la galette des rois">
                        
                        <div class="form-group">
                            <label for="email-gal">Email :</label>
                            <input type="email" id="email-gal" name="email" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="nom-gal">Nom :</label>
                            <input type="text" id="nom-gal" name="nom" required>
                        </div>
                        <div class="form-group">
                            <label for="prenom-gal">PrÃ©nom :</label>
                            <input type="text" id="prenom-gal" name="prenom" required>
                        </div>
                        <div class="form-group">
                            <label for="numero-gal">NumÃ©ro de tÃ©lÃ©phone :</label>
                            <input type="tel" id="numero-gal" name="telephone" pattern="[0-9]{10}" placeholder="Ex: 0612345678" required>
                        </div>
                        <button type="submit" class="submit-btn galette-submit-btn">Je m'inscris !</button>
                    </form>
                </div>
            </div>
        </template>
        
        <template id="noel-template">
        <div class="noel-wrapper">
            <div class="registration-container noel-form-container">
                <h1><span class="noel-icon">ğŸŒŸ</span> Inscription SoirÃ©e de NoÃ«l</h1>
                <p>RÃ©servez votre place pour une soirÃ©e magique d'Ã©change de cadeaux et de bonne humeur !</p>
                <form action="inscription_event.php" method="POST" class="registration-form">
                    <input type="hidden" name="evenement" value="SoirÃ©e de NoÃ«l">
                    
                    <div class="form-group">
                        <label for="email-noel">Email :</label>
                        <span class="input-icon">ğŸ“§</span> <input type="email" id="email-noel" name="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="nom-noel">Nom :</label>
                        <span class="input-icon">ğŸ</span> <input type="text" id="nom-noel" name="nom" required>
                    </div>
                    <div class="form-group">
                        <label for="prenom-noel">PrÃ©nom :</label>
                        <span class="input-icon">ğŸ„</span> <input type="text" id="prenom-noel" name="prenom" required>
                    </div>
                    <div class="form-group">
                        <label for="numero-noel">NumÃ©ro de tÃ©lÃ©phone :</label>
                        <span class="input-icon">ğŸ””</span> <input type="tel" id="numero-noel" name="telephone" pattern="[0-9]{10}" placeholder="Ex: 0612345678" required>
                    </div>
                    <button type="submit" class="submit-btn noel-submit-btn">
                        Joyeuse Inscription <span class="btn-icon">ğŸ…</span>
                    </button>
                </form>
            </div>
        </div>
        </template>
        
        <template id="map-modal-template">
            <div class="map-wrapper">
                <h2 class="map-title">Lieu de l'Ã©vÃ©nement : <span id="event-map-title"></span></h2>
                <div id="map-container">
                    <iframe id="google-map-iframe" width="100%" height="450" frameborder="0" style="border:0;" allowfullscreen="" aria-hidden="false" tabindex="0"></iframe>
                </div>
                <p class="map-address-display">Adresse : <strong id="map-address-text"></strong></p>
            </div>
        </template>

    <div id="modal" class="modal hidden" aria-hidden="true">
        <div class="modal-overlay"></div>
        <div class="modal-box">
            <button class="modal-close" aria-label="Fermer">Ã—</button>
            <div class="modal-body"></div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById('modal');
            const modalBody = modal.querySelector('.modal-body');
            const closeBtn = modal.querySelector('.modal-close');
            const statusContainer = document.getElementById('status-message-container'); // NOUVEAU
            
            const registerButtons = document.querySelectorAll('a.event-button[data-template-id]');
            const locationButtons = document.querySelectorAll('.location-button');
            
            // --- NOUVELLE FONCTION : Affichage des messages de statut ---
            const displayStatusMessage = (message, type = 'success') => {
                statusContainer.innerHTML = `<div class="status-message ${type}">${message}</div>`;
                statusContainer.style.display = 'block';
                // Efface le message aprÃ¨s 8 secondes
                setTimeout(() => {
                    statusContainer.style.display = 'none';
                    statusContainer.innerHTML = '';
                }, 8000);
            };
            
            // --- NOUVELLE FONCTION : Gestion des paramÃ¨tres URL ---
            const urlParams = new URLSearchParams(window.location.search);
            const success = urlParams.get('success');
            const errorMsg = urlParams.get('error');
            const eventName = urlParams.get('event');
            const emailError = urlParams.get('email_error');
            const smsError = urlParams.get('sms_error');

            if (success === 'true' && eventName) {
                let message = `Inscription Ã  l'Ã©vÃ©nement "${decodeURIComponent(eventName)}" rÃ©ussie !`;
                
                if (emailError) {
                    message += " âš ï¸ E-mail de confirmation non envoyÃ© (erreur serveur).";
                }
                if (smsError) {
                    message += " âš ï¸ SMS de confirmation non envoyÃ© (erreur API).";
                }
                
                displayStatusMessage(message, 'success');
                
            } else if (errorMsg) {
                displayStatusMessage(`Erreur lors de l'inscription : ${decodeURIComponent(errorMsg)}`, 'error');
            }

            // Nettoyer l'URL aprÃ¨s l'affichage du message (pour Ã©viter que le message ne rÃ©apparaisse au rechargement)
            if (success || errorMsg) {
                history.replaceState(null, '', 'evenement.html');
            }
            // ------------------------------------------------------------------

            // Fonction pour afficher la modale
            const showModal = (contentHTML) => {
                modalBody.innerHTML = contentHTML;
                modal.classList.remove('hidden');
                modal.setAttribute('aria-hidden', 'false');
            };

            // Gestionnaire pour les boutons "S'inscrire"
            registerButtons.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();

                    const templateId = btn.getAttribute('data-template-id');
                    const template = document.getElementById(templateId);

                    if (template) {
                        showModal(template.innerHTML);
                    }
                });
            });
            
            // Gestionnaire pour les boutons "Lieu ğŸ“"
            locationButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const address = btn.getAttribute('data-location');
                    const eventTitle = btn.getAttribute('data-event-title');
                    
                    const mapTemplate = document.getElementById('map-modal-template');
                    
                    if (mapTemplate && address) {
                        showModal(mapTemplate.innerHTML);
                        
                        // Construit l'URL pour l'API Google Maps Embed
                        const encodedAddress = encodeURIComponent(address);
                        // IMPORTANT : URL d'exemple. Vous devez avoir une CLÃ‰ API valide !
                        const mapUrl = `https://www.google.com/maps/embed/v1/place?q=${encodedAddress}&key=AIzaSyBUF-nMqx2r19iHmnzkbeaR1nWopM-atms`;
                        
                        const mapIframe = document.getElementById('google-map-iframe');
                        const mapTitle = document.getElementById('event-map-title');
                        const mapAddressText = document.getElementById('map-address-text');

                        if (mapIframe) mapIframe.src = mapUrl;
                        if (mapTitle) mapTitle.textContent = eventTitle;
                        if (mapAddressText) mapAddressText.textContent = address;

                    }
                });
            });


            // Gestionnaires de fermeture
            closeBtn.addEventListener('click', () => { modal.classList.add('hidden'); modal.setAttribute('aria-hidden', 'true'); });
            modal.addEventListener('click', (ev) => { if (ev.target === modal || ev.target.classList.contains('modal-overlay')) { modal.classList.add('hidden'); modal.setAttribute('aria-hidden', 'true'); } });

            
        });
    </script>
    <script src="js1.js"></script>

</body>
</html>